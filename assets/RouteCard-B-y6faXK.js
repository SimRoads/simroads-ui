import{B as H,a as O}from"./BaseCard-YwwZ8Pbe.js";import{p as D,m as z,a as w,d as G,g as I,e as K,n as Q,A as X,t as _,h as V,u as b,c as a,j as S,a1 as x,s as Y,x as k,w as T,H as Z,Q as J,I as p,a2 as ee,L as h,M as C,K as g,W as te,Y as ie,S as ne,F as le,N as ae,Z as se,P as oe,X as re,a3 as L,a0 as de}from"./index-iVPC1WgH.js";import{k as ce,l as ue,b as j,n as F,a as M,o as me,u as N,e as ve,d as fe,h as W,V as ye,p as Ce,q as ge}from"./VAvatar-dmscyC76.js";import{V as ke}from"./VBadge-MtHYe8_s.js";import"./VBtn-DlegZ2NC.js";function _e(e){return new Worker("/CHANGE_ME_BASE_URL/assets/route-Ceu-l1sB.js",{name:e==null?void 0:e.name})}const he=D({align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...z(),...ce(),...w(),...G()},"VTimeline"),Se=I()({name:"VTimeline",props:he(),setup(e,v){let{slots:l}=v;const{themeClasses:m}=K(e),{densityClasses:c}=ue(e),{rtlClasses:i}=Q();X({VTimelineDivider:{lineColor:_(e,"lineColor")},VTimelineItem:{density:_(e,"density"),lineInset:_(e,"lineInset")}});const r=V(()=>{const d=e.side?e.side:e.density!=="default"?"end":null;return d&&`v-timeline--side-${d}`}),s=V(()=>{const d=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return d;case"start":return d[0];case"end":return d[1];default:return null}});return b(()=>a(e.tag,{class:["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,s.value,{"v-timeline--inset-line":!!e.lineInset},m.value,c.value,r.value,i.value,e.class],style:[{"--v-timeline-line-thickness":S(e.lineThickness)},e.style]},l)),{}}}),Ve=D({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:x,iconColor:String,lineColor:String,...z(),...j(),...F(),...M()},"VTimelineDivider"),Te=I()({name:"VTimelineDivider",props:Ve(),setup(e,v){let{slots:l}=v;const{sizeClasses:m,sizeStyles:c}=me(e,"v-timeline-divider__dot"),{backgroundColorStyles:i,backgroundColorClasses:r}=N(_(e,"dotColor")),{roundedClasses:s}=ve(e,"v-timeline-divider__dot"),{elevationClasses:d}=fe(e),{backgroundColorClasses:y,backgroundColorStyles:f}=N(_(e,"lineColor"));return b(()=>a("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot},e.class],style:e.style},[a("div",{class:["v-timeline-divider__before",y.value],style:f.value},null),!e.hideDot&&a("div",{key:"dot",class:["v-timeline-divider__dot",d.value,s.value,m.value],style:c.value},[a("div",{class:["v-timeline-divider__inner-dot",r.value,s.value],style:i.value},[l.default?a(ye,{key:"icon-defaults",disabled:!e.icon,defaults:{VIcon:{color:e.iconColor,icon:e.icon,size:e.size}}},l.default):a(W,{key:"icon",color:e.iconColor,icon:e.icon,size:e.size},null)])]),a("div",{class:["v-timeline-divider__after",y.value],style:f.value},null)])),{}}}),De=D({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:x,iconColor:String,lineInset:[Number,String],...z(),...Ce(),...M(),...j(),...F(),...w()},"VTimelineItem"),$=I()({name:"VTimelineItem",props:De(),setup(e,v){let{slots:l}=v;const{dimensionStyles:m}=ge(e),c=Y(0),i=k();return T(i,r=>{var s;r&&(c.value=((s=r.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:s.getBoundingClientRect().width)??0)},{flush:"post"}),b(()=>{var r,s;return a("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot},e.class],style:[{"--v-timeline-dot-size":S(c.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${S(e.lineInset)})`:S(0)},e.style]},[a("div",{class:"v-timeline-item__body",style:m.value},[(r=l.default)==null?void 0:r.call(l)]),a(Te,{ref:i,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:l.icon}),e.density!=="compact"&&a("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((s=l.opposite)==null?void 0:s.call(l))])])}),{}}}),ze={class:"text-subtitle-2 text-grey"},Ie=Z({__name:"RouteCard",props:{places:{}},setup(e){const v=e,l=k(!1),m=k(!1),c=k(!1),i=k(null),r=V(()=>v.places.map(t=>t.split(";").map(Number))),s=J(),d=p(),y=(t,n)=>{const o=["roads","ferries"];t==null||t.forEach(u=>u.links.forEach(E=>E.mapIds.forEach(U=>o.forEach(q=>{var R;return(R=s.map)==null?void 0:R.setFeatureState({id:U,source:"tiles",sourceLayer:q},{route:n})}))))};ee(()=>{f.terminate(),y(i.value,!1)}),T(i,(t,n)=>{n&&y(n,!1),t&&y(t,!0)});const f=new _e;f.addEventListener("message",t=>{t.data==="ready"&&(m.value=!0,B(r.value),T(r,n=>B(n)))},{once:!0});const B=t=>{l.value=!1,c.value=!1;const n={points:t};f.addEventListener("message",o=>{o.data.error?(c.value=!0,i.value=null):i.value=o.data,l.value=!0},{once:!0}),f.postMessage(n)},A=t=>t.links.reduce((n,o)=>n+o.length,0);V(()=>i.value?i.value.reduce((t,n)=>t+A(n),0):0);const P=t=>{var n;if(i.value&&d.map){const o=i.value[Math.max(t-1,0)];(n=s.map)==null||n.fitBounds([L(d.map,o.start.x,o.start.z),L(d.map,o.end.x,o.end.z)],{padding:100})}};return(t,n)=>(g(),h(H,{title:t.$t("route_info"),"prepend-icon":"mdi-directions",loading:!m.value||!l.value},{default:C(()=>[i.value?(g(),h(Se,{key:0,direction:"horizontal"},{default:C(()=>[(g(!0),te(le,null,ie(i.value,(o,u)=>(g(),h($,{key:u,size:"small",icon:"mdi-flag","dot-color":"primary",onClick:E=>P(u),class:"pointer"},ne({_:2},[u!=0?{name:"icon",fn:C(()=>[a(ke,{content:u,inline:""},null,8,["content"])]),key:"0"}:void 0]),1032,["onClick"]))),128)),a($,{class:"pointer",size:"small",icon:"mdi-flag-checkered","dot-color":"primary",onClick:n[0]||(n[0]=o=>{var u;return P(((u=i.value)==null?void 0:u.length)||0)})})]),_:1})):c.value?(g(),h(O,{key:1,class:"w-100 text-center"},{default:C(()=>[a(W,{color:"grey",size:"64"},{default:C(()=>[ae("mdi-alert")]),_:1}),se("div",ze,oe(t.$t("route_not_found")),1)]),_:1})):re("",!0)]),_:1},8,["title","loading"]))}}),Le=de(Ie,[["__scopeId","data-v-ab932749"]]);export{Le as default};
